<html layout:decorator="views/layout" xmlns:th="http://www.thymeleaf.org" xmlns:tiles="http://www.thymeleaf.org">
<body>
<div layout:fragment="content">
    <div class="col-lg-12">
        <div class="col-lg-2">
            <a class="btn btn-primary" ng-click="nieuwHoofdCode()">New</a>
        </div>
        <div class="col-lg-2">
            <a class="btn btn-primary" href="/accounting/accountingModel">Choose Year</a>
        </div>
    </div>
    <div class="col-lg-12">
        <table st-safe-src="hoofdCodes" st-table="emptyHoofdCodes" class="table table-striped table-hover ">
            <thead>
            <tr>
                <th></th>
                <th st-sort="Name">Name</th>
                <th>Account Codes</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="hoofdCode in emptyHoofdCodes">
                <td><a class="btn btn-primary" ng-click="deleteGroup(hoofdCode)">Delete</a></td>
                <td>{{hoofdCode.name}}</td>
                <td><a class="btn btn-primary" ng-click="">Acount Codes</a></td>
                <td></td>
            </tr>
            </tbody>
            <tfoot>
            <tr>
                <td colspan="4" class="text-center">
                    <div st-pagination="" st-items-by-page="10" st-displayed-pages="100"></div>
                </td>
            </tr>
            </tfoot>
        </table>
    </div>

    <div id="dialogNieuwHoofdCode" class="modal-dialog" title="Basic dialog">
        <div class="col-lg-12">
            <label for="name" class="col-lg-4 control-label">New Group</label>
            <div class="col-lg-8">
                <input class="form-control" id="name" ng-model="hoofdCode.name" placeholder="Name" type="text"/>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        $( "#dialogNieuwHoofdCode" ).hide();

        app.controller("fController", function($scope, $http) {
            var url_code_hoofd_groep = /*[[@{/json/code_hoofd_groep}]]*/;
            $http.get(url_code_hoofd_groep).success( function(data){
                $scope.hoofdCodes = data;
            });

            $scope.nieuwHoofdCode = function(){
                $scope.hoofdCode = { name: "" };
                $('#dialogNieuwHoofdCode').dialog({
                    title: "Enter new main group",
                    width: 500,
                    buttons: { "OK": function() {
                        var url =/*[[@{/json/code_hoofd_groep}]]*/;
                        $http.post(url, $scope.hoofdCode).error( function(){
                            bootbox.alert("Error occured during setting security keys");
                        }).success( function (data){
                            $scope.hoofdCodes = data;
                            $( "#dialogNieuwHoofdCode" ).dialog("close");
                        });
                    }}
                });
            }

            $scope.deleteGroup = (function(hoofdCode){
                 bootbox.confirm("Are you sure you want to delete this group?", function(result) {
                    if (result === true){
                        var url = /*[[@{/json/code_hoofd_groep/}]]*/;
                        $http.delete(url + hoofdCode.pkId).success( function(data) {
                            $scope.hoofdCodes = data;
                        }).error( function(){
                          bootbox.alert("Error occured during delete");
                        });
                    }
                });
            });
        });
    </script>
</div>
</body>
</html>
